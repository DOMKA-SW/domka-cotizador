<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <link rel="icon" href="img/favicon.ico" type="image/x-icon">
  <title>DOMKA · Dashboard</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <script src="https://cdn.tailwindcss.com"></script>

<style>
@import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');

body {
  font-family: 'Inter', sans-serif;
  background: linear-gradient(135deg, #ffffff 0%, #f3f4f6 100%);
  color: #111827;
}

/* Botón principal */
.btn-primary {
  background: linear-gradient(135deg, #1a7a4a, #14613b);
  color: white;
  font-weight: 600;
  border-radius: 10px;
  padding: 0.6rem 1.2rem;
  transition: all .25s ease;
  box-shadow: 0 6px 20px rgba(26,122,74,.25);
}
.btn-primary:hover {
  transform: translateY(-2px);
  box-shadow: 0 10px 28px rgba(26,122,74,.35);
}

/* Cards */
.card {
  background: white;
  border-radius: 14px;
  border: 1px solid #e5e7eb;
  transition: all .3s ease;
}
.card:hover {
  transform: translateY(-4px);
  box-shadow: 0 18px 35px rgba(0,0,0,.08);
  border-left: 4px solid #1a7a4a;
}

/* Accesos */
.access-card {
  background: white;
  border-radius: 14px;
  border: 1px solid #e5e7eb;
  transition: all .3s ease;
}
.access-card:hover {
  transform: translateY(-4px);
  box-shadow: 0 16px 30px rgba(0,0,0,.08);
}

/* Header text */
.header-gradient {
  background: linear-gradient(90deg, #0f172a, #1a7a4a);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  font-weight: 700;
}

/* Badge */
.stat-badge {
  position: absolute;
  top: -10px;
  right: -10px;
  background: #1a7a4a;
  color: white;
  border-radius: 999px;
  min-width: 26px;
  height: 26px;
  padding: 0 8px;
  font-size: .75rem;
  font-weight: 700;
  display: flex;
  align-items: center;
  justify-content: center;
  box-shadow: 0 4px 10px rgba(26,122,74,.35);
  border: 2px solid white;
}
</style>
</head>

<body class="min-h-screen">
<div class="p-4 md:p-6 max-w-6xl mx-auto">

<!-- HEADER -->
<header class="flex flex-col md:flex-row justify-between items-start md:items-center mb-10 p-6 bg-white rounded-2xl shadow border">
  <div>
    <h1 class="text-3xl header-gradient">DOMKA</h1>
    <p class="text-gray-500 mt-1">Panel de control</p>
  </div>

  <div class="flex items-center gap-4 mt-4 md:mt-0">
    <span class="text-sm text-gray-600" id="user-email">Cargando…</span>
    <button onclick="logout()" class="btn-primary flex items-center gap-2">
      Cerrar sesión
    </button>
  </div>
</header>

<!-- BIENVENIDA -->
<section class="mb-10 p-6 bg-gradient-to-r from-gray-900 to-gray-800 rounded-2xl text-white">
  <h2 class="text-2xl font-bold mb-2">Bienvenido a tu dashboard</h2>
  <p class="opacity-90">Consulta métricas clave y accede rápidamente a tus herramientas.</p>
</section>

<!-- RESUMEN -->
<section class="mb-10">
  <h2 class="text-xl font-bold mb-4 text-gray-800">Resumen general</h2>

  <div class="grid grid-cols-1 md:grid-cols-3 gap-5">
    <div id="card-cot" class="card p-5 relative">
      <h3 class="font-semibold text-gray-600">Cotizaciones</h3>
      <p class="text-3xl font-bold text-gray-900" id="count-cot">—</p>
    </div>

    <div id="card-cuentas" class="card p-5 relative">
      <h3 class="font-semibold text-gray-600">Cuentas de cobro</h3>
      <p class="text-3xl font-bold text-gray-900" id="count-cuentas">—</p>
    </div>

    <div class="card p-5">
      <h3 class="font-semibold text-gray-600">Ingresos pagados</h3>
      <p class="text-3xl font-bold text-green-700" id="sum-pagadas">—</p>
    </div>
  </div>
</section>

<!-- ACCESOS -->
<section>
  <h2 class="text-xl font-bold mb-4 text-gray-800">Accesos rápidos</h2>

  <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-5">
    <a href="cotizaciones.html" class="access-card p-6 text-center">
      <h3 class="font-bold">Cotizaciones</h3>
      <p class="text-sm text-gray-500">Crear y gestionar</p>
    </a>

    <a href="cuentas.html" class="access-card p-6 text-center">
      <h3 class="font-bold">Cuentas</h3>
      <p class="text-sm text-gray-500">Cobros y estados</p>
    </a>

    <a href="clientes.html" class="access-card p-6 text-center">
      <h3 class="font-bold">Clientes</h3>
      <p class="text-sm text-gray-500">Administración</p>
    </a>

    <a href="contabilidad.html" class="access-card p-6 text-center">
      <h3 class="font-bold">Contabilidad</h3>
      <p class="text-sm text-gray-500">Reportes</p>
    </a>
  </div>
</section>

<footer class="mt-14 pt-6 border-t text-center text-sm text-gray-500">
  © 2025 DOMKA · Todos los derechos reservados
</footer>
</div>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>
<script src="js/firebase.js"></script>
<script src="js/auth.js"></script>

<script>
auth.onAuthStateChanged(user => {
  document.getElementById("user-email").textContent = user?.email || "Usuario";
});

function logout() {
  auth.signOut().then(() => location.href = "home.html");
}

(async function () {
  const cotSnap = await db.collection("cotizaciones").get();
  const cuentasSnap = await db.collection("cuentas").get();

  count-cot.textContent = cotSnap.size;
  count-cuentas.textContent = cuentasSnap.size;

  let total = 0;
  cuentasSnap.forEach(d => {
    if (d.data().estado === "pagada") total += Number(d.data().total || 0);
  });
  sum-pagadas.textContent = `$${total.toLocaleString("es-CO")}`;

  const pendientes = cuentasSnap.docs.filter(d => d.data().estado === "pendiente").length;
  if (pendientes) {
    const badge = document.createElement("div");
    badge.className = "stat-badge";
    badge.textContent = pendientes;
    document.getElementById("card-cuentas").appendChild(badge);
  }
})();
</script>
</body>
</html>
